<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>í†µí•© í˜ì´ì§€</title>
  
  <style>
    :root {
      --primary-blue: #3182F6;
      --primary-blue-light: #4593FC;
      --violet-purple: #8B5CF6;
      --white: #FFFFFF;
      --gray-50: #F9FAFB;
      --gray-100: #F3F4F6;
      --gray-200: #E5E7EB;
      --gray-600: #4B5563;
      --gray-700: #374151;
      --gray-800: #1F2937;
      --branch-sangmu: #10B981;
      --branch-sinchang: #3B82F6;
      --branch-ochi: #F59E0B;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    html, body {
      height: 100%;
      width: 100%;
      font-family: -apple-system, BlinkMacSystemFont, "Apple SD Gothic Neo", "Pretendard", sans-serif;
      background: linear-gradient(135deg, var(--gray-50) 0%, var(--white) 100%);
    }

    .container {
      width: 100%;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      padding: 8px;
      box-sizing: border-box;
    }

    .result-container {
      flex-shrink: 0;
      background: var(--white);
      color: var(--gray-800);
      border-radius: 12px;
      padding: 12px;
      border: 1px solid var(--gray-200);
      font-weight: 600;
      margin-bottom: 8px;
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
    }

    /* ë©”ì¸ ì¹´ë“œ ê·¸ë¦¬ë“œ - ë°˜ì‘í˜• ê°œì„  */
    .toggle-container {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      width: 100%;
      justify-content: center;
    }

    .toggle-button {
      flex: 1 1 calc(12.5% - 8px);
      min-width: 120px;
      max-width: 140px;
    }

    /* ì¤„ë°”ê¿ˆ ì‹œ ê· ë“± ë°°ì¹˜ */
    @media screen and (max-width: 1200px) {
      .toggle-button {
        flex: 1 1 calc(25% - 8px);
        min-width: 110px;
      }
    }

    @media screen and (max-width: 768px) {
      .toggle-container {
        gap: 6px;
      }
      
      .toggle-button {
        flex: 1 1 calc(50% - 6px);
        min-width: 90px;
        max-width: none;
      }
    }

    /* ì¹´ë“œí˜• ë©”ì¸ ë²„íŠ¼ - í¬ê¸° ì¶•ì†Œ */
    .toggle-button {
      border: none;
      background: var(--white);
      color: var(--gray-700);
      padding: 12px 8px;
      cursor: pointer;
      border-radius: 10px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      font-size: 12px;
      font-weight: 600;
      text-align: center;
      border: 2px solid var(--gray-200);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      position: relative;
      overflow: hidden;
    }

    .toggle-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-blue) 0%, var(--primary-blue-light) 100%);
      transform: scaleX(0);
      transition: transform 0.3s ease;
    }

    .toggle-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px -5px rgba(0, 0, 0, 0.1);
      border-color: var(--primary-blue);
    }

    .toggle-button:hover::before {
      transform: scaleX(1);
    }

    .toggle-button.active {
      background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-blue-light) 100%);
      color: var(--white);
      border-color: var(--primary-blue);
      box-shadow: 0 4px 12px 0 rgba(49, 130, 246, 0.4);
      transform: translateY(-2px);
    }

    .toggle-button.active::before {
      transform: scaleX(1);
      background: var(--white);
      opacity: 0.3;
    }

    /* íŠ¹ë³„ ë²„íŠ¼ë“¤ (ì´ì›”ëŒ€ìƒì, ë…¸ì‡¼ì²´í¬) */
    #button6.active, #button7.active {
      background: linear-gradient(135deg, var(--violet-purple) 0%, #A78BFA 100%);
      box-shadow: 0 4px 12px 0 rgba(139, 92, 246, 0.4);
    }

    /* ë²„íŠ¼ ì•„ì´ì½˜ - í¬ê¸° ì¶•ì†Œ */
    .button-icon {
      font-size: 20px;
      margin-bottom: 2px;
      filter: drop-shadow(0 1px 2px rgba(0,0,0,0.1));
    }

    /* í†µí•©ëœ ì„œë¸Œ ë²„íŠ¼ ì»¨í…Œì´ë„ˆ - í¬ê¸° ì¶•ì†Œ */
    .branch-sub-container {
      display: none;
      margin-top: 8px;
      padding: 8px;
      background: var(--gray-100);
      border-radius: 10px;
    }

    .branch-sub-container.show {
      display: block;
    }

    .branch-buttons {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
    }

    .branch-toggle-button {
      border: none;
      background: var(--white);
      color: var(--gray-700);
      padding: 8px 6px;
      cursor: pointer;
      border-radius: 6px;
      transition: all 0.2s ease;
      font-size: 11px;
      font-weight: 600;
      text-align: center;
      border: 2px solid var(--gray-200);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 3px;
    }

    .branch-toggle-button:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 8px -2px rgba(0, 0, 0, 0.1);
      border-color: var(--primary-blue);
    }

    .branch-toggle-button.active {
      background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-blue-light) 100%);
      color: var(--white);
      border-color: var(--primary-blue);
      box-shadow: 0 2px 8px 0 rgba(49, 130, 246, 0.3);
      transform: translateY(-1px);
    }

    /* ì§€ì ë³„ ìƒ‰ìƒ */
    .branch-toggle-button.sangmu.active {
      background: linear-gradient(135deg, var(--branch-sangmu) 0%, #34D399 100%);
      box-shadow: 0 2px 8px 0 rgba(16, 185, 129, 0.3);
    }

    .branch-toggle-button.sinchang.active {
      background: linear-gradient(135deg, var(--branch-sinchang) 0%, #60A5FA 100%);
      box-shadow: 0 2px 8px 0 rgba(59, 130, 246, 0.3);
    }

    .branch-toggle-button.ochi.active {
      background: linear-gradient(135deg, var(--branch-ochi) 0%, #FBBF24 100%);
      box-shadow: 0 2px 8px 0 rgba(245, 158, 11, 0.3);
    }

    .branch-toggle-button.staff.active {
      background: linear-gradient(135deg, var(--violet-purple) 0%, #A78BFA 100%);
      box-shadow: 0 2px 8px 0 rgba(139, 92, 246, 0.3);
    }

    /* iframe ì»¨í…Œì´ë„ˆ - ë†’ì´ ì¡°ì • */
    .dataFrame-container {
      flex: 1;
      position: relative;
      min-height: 400px;
      overflow: hidden;
      transition: opacity .3s ease;
      display: flex;
      flex-direction: column;
      background: var(--white);
      border-radius: 12px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--gray-200);
      margin-bottom: 8px;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
      border-radius: 12px;
      display: block;
      flex-grow: 1;
    }

    .shin-container {
      flex-grow: 1;
      transition: opacity .3s ease;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      width: 100%;
      height: 100%;
    }

    .shin-stack {
      position: relative;
      width: 100%;
      height: 100%;
      min-height: 400px;
      border: 1px solid var(--gray-200);
      border-radius: 12px;
      box-sizing: border-box;
      flex-grow: 1;
      overflow: hidden;
    }

    .shin-stack iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      display: block;
      border: 0;
      border-radius: 12px;
      transform: scale(1.0);
      transform-origin: top left;
      background: var(--white);
    }

    /* ë¡œë”© ìŠ¤íƒ€ì¼ */
    .loading-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(4px);
      z-index: 999;
      display: none;
      border-radius: 16px;
    }

    .loader {
      border: 4px solid var(--gray-200);
      border-top: 4px solid var(--primary-blue);
      border-radius: 50%;
      width: 48px;
      height: 48px;
      animation: spin 1s linear infinite;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      z-index: 9999;
      display: none;
    }

    @keyframes spin {
      0% { transform: translate(-50%, -50%) rotate(0deg); }
      100% { transform: translate(-50%, -50%) rotate(360deg); }
    }

    [hidden] {
      display: none !important;
    }

    /* ëª¨ë°”ì¼ ìµœì í™” */
    @media screen and (max-width: 768px) {
      .container {
        padding: 8px;
      }
      
      .result-container {
        padding: 16px;
        margin-bottom: 8px;
        border-radius: 12px;
      }

      .toggle-container {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
      }
      
      .toggle-button {
        padding: 12px 8px;
        font-size: 12px;
        border-radius: 10px;
      }

      .button-icon {
        font-size: 20px;
      }

      .branch-buttons {
        grid-template-columns: repeat(2, 1fr);
        gap: 6px;
      }

      .branch-toggle-button {
        padding: 8px 6px;
        font-size: 11px;
      }

      iframe {
        width: 110% !important;
        height: 100% !important;
        transform-origin: top left !important;
        transform: scale(0.91) !important;
        border-radius: 12px !important;
      }

      .shin-stack iframe {
        width: 110% !important;
        height: 100% !important;
        transform: scale(0.91) !important;
        transform-origin: top left !important;
        border-radius: 12px !important;
      }

      .dataFrame-container {
        border-radius: 12px;
        height: 800px;
        min-height: 800px;
      }

      .shin-stack {
        border-radius: 12px;
        min-height: 800px;
      }
    }

    @media screen and (max-height: 600px) {
      .result-container {
        padding: 12px;
      }
      
      .toggle-button {
        padding: 8px 6px;
        font-size: 11px;
      }

      .button-icon {
        font-size: 18px;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="result-container">
      <div class="toggle-container">
        <button class="toggle-button active" id="button1">
          <div class="button-icon">ğŸ“Š</div>
          ì¢…í•©í˜„í™© ì°¨íŠ¸
        </button>
        <button class="toggle-button" id="button2">
          <div class="button-icon">ğŸ“…</div>
          ì›”ë‹¨ìœ„ ë‹¬ì„±í˜„í™©
        </button>
        <button class="toggle-button" id="button3">
          <div class="button-icon">ğŸ’°</div>
          ì¸ì„¼ë‚´ì—­ ë° ì •ì±…
        </button>
        <button class="toggle-button" id="button4">
          <div class="button-icon">ğŸ‘¥</div>
          ì—°ê°„ íšŒì›ìˆ˜
        </button>
        <button class="toggle-button" id="button5">
          <div class="button-icon">ğŸ¢</div>
          ì§€ì  ëŒ€ì‹œë³´ë“œ
        </button>
        <button class="toggle-button" id="button6">
          <div class="button-icon">ğŸ“‹</div>
          ì´ì›”ëŒ€ìƒì
        </button>
        <button class="toggle-button" id="button7">
          <div class="button-icon">âŒ</div>
          ë…¸ì‡¼ì²´í¬
        </button>
        <button class="toggle-button" id="button8">
          <div class="button-icon">ğŸ“¦</div>
          ë°°ì†¡ìƒí’ˆ í™•ì¸
        </button>
      </div>

      <!-- ì§€ì  ëŒ€ì‹œë³´ë“œ ì„œë¸Œ ë²„íŠ¼ë“¤ (í†µí•©ëœ 4ê°œ ë²„íŠ¼) -->
      <div class="branch-sub-container" id="branchSubContainer">
        <div class="branch-buttons">
          <button class="branch-toggle-button sangmu active" 
            data-url="https://lookerstudio.google.com/embed/reporting/64be6fe1-640e-457b-9108-1c70d60e666e/page/buSUF">
            ğŸŒ¿ ìƒë¬´ì  ëŒ€ì‹œë³´ë“œ
          </button>
          <button class="branch-toggle-button sinchang" 
            data-url="https://lookerstudio.google.com/embed/reporting/64be6fe1-640e-457b-9108-1c70d60e666e/page/p_gfze1gk9ud" 
            id="shinBtn">
            ğŸ’™ ì‹ ì°½ì  ëŒ€ì‹œë³´ë“œ
          </button>
          <button class="branch-toggle-button ochi" 
            data-url="https://lookerstudio.google.com/embed/reporting/64be6fe1-640e-457b-9108-1c70d60e666e/page/p_suzy22l9ud">
            ğŸ§¡ ì˜¤ì¹˜ì  ëŒ€ì‹œë³´ë“œ
          </button>
          <button class="branch-toggle-button staff" 
            data-url="https://lookerstudio.google.com/embed/reporting/64be6fe1-640e-457b-9108-1c70d60e666e/page/p_d1s8t8pavd">
            ğŸ‘¨â€ğŸ’¼ ì „ì§€ì  ë‹´ë‹¹ìë³„ ë“±ë¡ë¥ 
          </button>
        </div>
      </div>
    </div>
    
    <div class="dataFrame-container" id="dataFrameContainer">
      <div class="loading-overlay"></div>
      <div class="loader"></div>
      
      <div id="shinContainer" class="shin-container" hidden>
        <div class="shin-stack">
          <iframe id="shinBranchFrame"
            src="https://lookerstudio.google.com/embed/reporting/64be6fe1-640e-457b-9108-1c70d60e666e/page/p_gfze1gk9ud"
            title="ì‹ ì°½ì  ëŒ€ì‹œë³´ë“œ" allowfullscreen loading="eager"></iframe>
          <iframe id="shinStaffFrame"
            src="https://lookerstudio.google.com/embed/reporting/695906da-94dd-4027-aa85-300c66ba158e/page/eMJQF"
            title="ë‹´ë‹¹ì ëŒ€ì‹œë³´ë“œ" allowfullscreen loading="eager" hidden></iframe>
        </div>
      </div>
      
      <iframe id="dataFrame"></iframe>
    </div>
  </div>

  <script>
    const dataFrame = document.getElementById('dataFrame');
    const buttons = document.querySelectorAll('.toggle-button');
    const branchButtons = document.querySelectorAll('.branch-toggle-button');
    const branchSubContainer = document.getElementById('branchSubContainer');
    const shinContainer = document.getElementById('shinContainer');
    const shinBranchFrame = document.getElementById('shinBranchFrame');
    const shinStaffFrame = document.getElementById('shinStaffFrame');
    const shinBtn = document.getElementById('shinBtn');
    const dataFrameContainer = document.getElementById('dataFrameContainer');

    let shinIsStaffMode = false;
    let branchSubVisible = false;
    let lastSelectedBranchIndex = 0; // ë§ˆì§€ë§‰ ì„ íƒëœ ì§€ì  ê¸°ì–µ

    const dataUrls = {
      button1: "https://soslyk.github.io/imweb/1.incentive/OverviewChart.html",
      button2: "https://soslyk.github.io/imweb/1.incentive/MonthlyProgress.html",
      button3: "https://soslyk.github.io/imweb/1.incentive/RewardPolicy.html",
      button4: "https://soslyk.github.io/imweb/1.incentive/ComparisonBranch.html",
      button6: "https://crossfitpaan.com/carryover",
      button7: "https://soslyk.github.io/imweb/1.incentive/noshow.html",
      button8: "https://crossfitpaan.com/checkdelivery"
    };

    // ê°œì„ ëœ ëª¨ë°”ì¼ í™”ë©´ ìŠ¤í¬ë¡¤ í•¨ìˆ˜
    function scrollToElement(element, offset = 0) {
      if (window.innerWidth <= 768) {
        setTimeout(() => {
          const rect = element.getBoundingClientRect();
          const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
          const targetTop = rect.top + scrollTop - offset;
          
          window.scrollTo({
            top: targetTop,
            behavior: 'smooth'
          });
        }, 150); // ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ í›„ ìŠ¤í¬ë¡¤
      }
    }

    function updateFrame(url) {
      const loader = document.querySelector('.loader');
      const overlay = document.querySelector('.loading-overlay');

      // If the requested URL is already loaded, do not reload (prevents refresh on toggle of sub buttons)
      if (dataFrame && dataFrame.src === url) {
        // Ensure any visible loader/overlay are hidden
        loader.style.display = 'none';
        overlay.style.display = 'none';
        return;
      }

      loader.style.display = 'block';
      overlay.style.display = 'block';

      dataFrame.onload = function() {
        setTimeout(() => {
          loader.style.display = 'none';
          overlay.style.display = 'none';
        }, 300);
      };

      dataFrame.src = url;
    }

    const activateButton = (btn, isMainButton = false) => {
      if (isMainButton) {
        buttons.forEach(b => b.classList.remove("active"));
      } else {
        branchButtons.forEach(b => b.classList.remove("active"));
      }
      btn.classList.add("active");
    };

    const updateShinLabel = () => {
      shinBtn.innerHTML = shinIsStaffMode ? "ğŸ‘¨â€ğŸ’¼ ë‹´ë‹¹ì ëŒ€ì‹œë³´ë“œ" : "ğŸ’™ ì‹ ì°½ì  ëŒ€ì‹œë³´ë“œ";
    };

    const showShin = () => {
      shinContainer.hidden = false;
      dataFrame.hidden = true;
      
      shinContainer.style.display = 'flex';
      shinContainer.style.height = '100%';
      shinContainer.style.flexGrow = '1';
      
      const shinStack = shinContainer.querySelector('.shin-stack');
      if (shinStack) {
        shinStack.style.height = '100%';
        shinStack.style.flexGrow = '1';
        shinStack.style.minHeight = '400px';
      }
      
      shinBranchFrame.hidden = shinIsStaffMode;
      shinStaffFrame.hidden = !shinIsStaffMode;
      
      setTimeout(() => {
        window.dispatchEvent(new Event('resize'));
      }, 100);
    };

    const showCommon = (url) => {
      shinContainer.hidden = true;
      shinContainer.style.display = 'none';
      dataFrame.hidden = false;
      dataFrame.style.display = 'block';
      updateFrame(url);
      shinIsStaffMode = false;
      updateShinLabel();
    };

    function setupMainButtons() {
      // ì¼ë°˜ ë©”ì¸ ë²„íŠ¼ë“¤ (ì„œë¸Œ ë²„íŠ¼ ì—†ìŒ)
      ['button1', 'button2', 'button3', 'button4', 'button6', 'button7', 'button8'].forEach(buttonId => {
        document.getElementById(buttonId).addEventListener('click', () => {
          activateButton(document.getElementById(buttonId), true);
          branchSubContainer.classList.remove('show');
          branchSubVisible = false;
          shinContainer.hidden = true;
          dataFrame.hidden = false;
          updateFrame(dataUrls[buttonId]);
          
          // ëª¨ë°”ì¼ì—ì„œ ë°ì´í„° ì»¨í…Œì´ë„ˆë¡œ ìŠ¤í¬ë¡¤
          scrollToElement(dataFrameContainer, 10);
        });
      });

      // ì§€ì  ëŒ€ì‹œë³´ë“œ ë²„íŠ¼ (ê°œì„ ëœ í† ê¸€ ê¸°ëŠ¥)
      document.getElementById('button5').addEventListener('click', () => {
        activateButton(document.getElementById('button5'), true);
        
        if (!branchSubVisible) {
          // ì„œë¸Œ ë²„íŠ¼ í‘œì‹œ
          branchSubContainer.classList.add('show');
          branchSubVisible = true;
          
          // ë§ˆì§€ë§‰ ì„ íƒëœ ì§€ì  ë²„íŠ¼ í™œì„±í™” (ë˜ëŠ” ì²« ë²ˆì§¸)
          branchButtons.forEach((b, index) => {
            b.classList.remove("active");
            if (index === lastSelectedBranchIndex) {
              b.classList.add("active");
            }
          });
          
          // ë§ˆì§€ë§‰ ì„ íƒëœ ì§€ì ì˜ ë°ì´í„° ë¡œë“œ
          const selectedButton = branchButtons[lastSelectedBranchIndex];
          if (selectedButton === shinBtn) {
            showShin();
          } else {
            shinContainer.hidden = true;
            dataFrame.hidden = false;
            updateFrame(selectedButton.dataset.url);
          }
          
          // ëª¨ë°”ì¼ì—ì„œ ì„œë¸Œ ë²„íŠ¼ìœ¼ë¡œ ìŠ¤í¬ë¡¤
          scrollToElement(branchSubContainer, 10);
        } else {
          // ì„œë¸Œ ë²„íŠ¼ ìˆ¨ê¸°ê¸° (ë°ì´í„°ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€)
          branchSubContainer.classList.remove('show');
          branchSubVisible = false;
          
          // ëª¨ë°”ì¼ì—ì„œ ë°ì´í„° ì»¨í…Œì´ë„ˆë¡œ ìŠ¤í¬ë¡¤
          scrollToElement(dataFrameContainer, 10);
        }
        
        updateShinLabel();
      });
    }

    function setupBranchButtons() {
      branchButtons.forEach((btn, index) => {
        btn.addEventListener("click", (e) => {
          e.preventDefault();
          e.stopPropagation();

          // ì„ íƒëœ ì§€ì  ì¸ë±ìŠ¤ ì €ì¥
          lastSelectedBranchIndex = index;

          if (btn === shinBtn) {
            if (!shinBtn.classList.contains("active")) {
              activateButton(shinBtn);
              shinIsStaffMode = false;
              updateShinLabel();
              showShin();
              return;
            }
            
            shinIsStaffMode = !shinIsStaffMode;
            updateShinLabel();
            showShin();
            return;
          }

          activateButton(btn);
          showCommon(btn.dataset.url);
        });
      });
    }

    document.addEventListener('DOMContentLoaded', function() {
      setupMainButtons();
      setupBranchButtons();
      
      updateFrame(dataUrls.button1);
      
      shinIsStaffMode = false;
      updateShinLabel();
      
      console.log('Step 1 ìµœì¢… ì™„ë£Œ: ì¹´ë“œ í¬ê¸° ì¶•ì†Œ + ê°œì„ ëœ í† ê¸€ + ìë™ ìŠ¤í¬ë¡¤ ìˆ˜ì •');
    });
  </script>
</body>
</html>